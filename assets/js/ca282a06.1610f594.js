/*! For license information please see ca282a06.1610f594.js.LICENSE.txt */
"use strict";(self.webpackChunkgoose=self.webpackChunkgoose||[]).push([[8380],{44276:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>d,default:()=>m,frontMatter:()=>c,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"guides/security/prompt-injection-detection","title":"Prompt Injection Detection","description":"Protect your workflow by detecting potentially harmful commands before they run.","source":"@site/docs/guides/security/prompt-injection-detection.md","sourceDirName":"guides/security","slug":"/guides/security/prompt-injection-detection","permalink":"/goose/docs/guides/security/prompt-injection-detection","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Prompt Injection Detection","sidebar_label":"Prompt Injection Detection","description":"Protect your workflow by detecting potentially harmful commands before they run."},"sidebar":"tutorialSidebar","previous":{"title":"Staying Safe with goose","permalink":"/goose/docs/guides/security/"},"next":{"title":"CLI Providers","permalink":"/goose/docs/guides/cli-providers"}}');var s=n(74848),i=n(28453),o=n(65537),l=n(79329),a=n(71112);const c={title:"Prompt Injection Detection",sidebar_label:"Prompt Injection Detection",description:"Protect your workflow by detecting potentially harmful commands before they run."},d=void 0,u={},h=[{value:"How Detection Works",id:"how-detection-works",level:2},{value:"Enabling Detection",id:"enabling-detection",level:2},{value:"Configuring Detection Threshold",id:"configuring-detection-threshold",level:3},{value:"See Also",id:"see-also",level:2}];function p(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"Prompt injection happens when malicious instructions are hidden inside executable content. In the world of AI, prompt injection can be used to nudge AI agents (like goose) to run unsafe commands that compromise your environment or data."}),"\n",(0,s.jsx)(t.p,{children:"You can help protect your goose workflows by enabling prompt injection detection. This feature uses pattern matching to detect common attack techniques, including:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Attempts to delete system files or directories"}),"\n",(0,s.jsx)(t.li,{children:"Commands that download and execute remote scripts"}),"\n",(0,s.jsx)(t.li,{children:"Attempts to access or exfiltrate sensitive data like SSH keys"}),"\n",(0,s.jsx)(t.li,{children:"System modifications that could compromise security"}),"\n"]}),"\n",(0,s.jsx)(t.admonition,{type:"important",children:(0,s.jsx)(t.p,{children:"These checks provide a safeguard, not a guarantee. They detect known patterns but cannot catch all possible threats, especially novel or sophisticated attacks."})}),"\n",(0,s.jsx)(t.h2,{id:"how-detection-works",children:"How Detection Works"}),"\n",(0,s.jsx)(t.p,{children:"When enabled, goose scans tool calls for risky patterns before they run:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Tool call is intercepted and analyzed"})," - When goose prepares to execute a tool, the security system extracts the tool parameter text and checks it against ",(0,s.jsx)(t.a,{href:"https://github.com/block/goose/blob/main/crates/goose/src/security/patterns.rs",children:"threat patterns"})]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Risk is assessed"})," - Detected threats are assigned confidence scores"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Execution pauses"})," - Threats that exceed your configured threshold need your decision"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Security alert appears"})," - The alert displays the confidence level, a description of the finding, and a unique finding ID. For example:","\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"\ud83d\udd12 Security Alert: This tool call has been flagged as potentially dangerous.\n\nConfidence: 95%\nExplanation: Detected 1 security threat: Recursive file deletion with rm -rf\nFinding ID: SEC-abc123...\n\n[Allow Once] [Deny]\n"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"You choose"})," whether to proceed or cancel after reviewing the alert details. Note that:","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Each decision is logged with its finding ID in the ",(0,s.jsx)(t.a,{href:"/docs/guides/logs#system-logs",children:"goose system logs"})]}),"\n",(0,s.jsx)(t.li,{children:"Allowed commands still run with your full permissions"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Responding to Alerts:"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Read the explanation to understand what triggered the detection"}),"\n",(0,s.jsx)(t.li,{children:"Consider your context\u2014does this match what you're trying to do?"}),"\n",(0,s.jsx)(t.li,{children:"Try rephrasing your request more specifically"}),"\n",(0,s.jsx)(t.li,{children:"Check the source and be extra cautious with prompts from unknown sources"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"When in doubt, deny."}),"\n",(0,s.jsx)(t.h2,{id:"enabling-detection",children:"Enabling Detection"}),"\n",(0,s.jsxs)(o.A,{groupId:"interface",children:[(0,s.jsx)(l.A,{value:"ui",label:"goose Desktop",default:!0,children:(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["Click the ",(0,s.jsx)(a.A,{className:"inline",size:16})," button in the top-left to open the sidebar"]}),"\n",(0,s.jsxs)(t.li,{children:["Click ",(0,s.jsx)(t.code,{children:"Settings"})," on the sidebar"]}),"\n",(0,s.jsxs)(t.li,{children:["Click the ",(0,s.jsx)(t.code,{children:"Chat"})," tab"]}),"\n",(0,s.jsxs)(t.li,{children:["Toggle ",(0,s.jsx)(t.code,{children:"Enable Prompt Injection Detection"})," to the on setting"]}),"\n",(0,s.jsxs)(t.li,{children:["Optionally adjust the ",(0,s.jsx)(t.code,{children:"Detection Threshold"})," to ",(0,s.jsx)(t.a,{href:"#configuring-detection-threshold",children:"configure the sensitivity"})]}),"\n"]})}),(0,s.jsxs)(l.A,{value:"config",label:"goose config file",children:[(0,s.jsxs)(t.p,{children:["Add these settings to your ",(0,s.jsx)(t.a,{href:"/docs/guides/config-file",children:(0,s.jsx)(t.code,{children:"config.yaml"})}),":"]}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",children:"security_prompt_enabled: true\nsecurity_prompt_threshold: 0.7  # Optional, default is 0.7\n"})})]})]}),"\n",(0,s.jsxs)(t.admonition,{title:"Other Security Features",type:"info",children:[(0,s.jsx)(t.p,{children:"Beyond prompt injection detection, goose automatically:"}),(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Warns you before running new or updated recipes"}),"\n",(0,s.jsx)(t.li,{children:"Warns you when importing recipes that contain invisible Unicode Tag Block characters"}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"/docs/troubleshooting#malicious-package-detected",children:"Checks for known malware"})," when installing extensions for locally-run MCP servers"]}),"\n"]})]}),"\n",(0,s.jsx)(t.h3,{id:"configuring-detection-threshold",children:"Configuring Detection Threshold"}),"\n",(0,s.jsx)(t.p,{children:"The threshold (0.01-1.0) controls how strict detection is:"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Threshold"}),(0,s.jsx)(t.th,{children:"Sensitivity"}),(0,s.jsx)(t.th,{children:"Use When"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"0.01-0.50"})}),(0,s.jsx)(t.td,{children:"Very lenient"}),(0,s.jsx)(t.td,{children:"You're experienced and understand the risks"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"0.50-0.70"})}),(0,s.jsx)(t.td,{children:"Balanced"}),(0,s.jsx)(t.td,{children:"General development work (good default)"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"0.70-0.90"})}),(0,s.jsx)(t.td,{children:"Strict"}),(0,s.jsx)(t.td,{children:"Working with sensitive data or systems"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"0.90-1.00"})}),(0,s.jsx)(t.td,{children:"Maximum"}),(0,s.jsx)(t.td,{children:"High-security environments"})]})]})]}),"\n",(0,s.jsx)(t.p,{children:"When the injection prompt detection feature is enabled, the default threshold is 0.7 (recommended for most users)."}),"\n",(0,s.jsx)(t.p,{children:"Lower thresholds mean fewer alerts but might miss threats. Higher thresholds catch more potential issues but may flag legitimate operations. You can control this sensitivity/convenience tradeoff based on your needs."}),"\n",(0,s.jsx)(t.h2,{id:"see-also",children:"See Also"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"/docs/guides/goose-permissions",children:"goose Permission Modes"})," - Control goose's autonomy level"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"/docs/guides/managing-tools/tool-permissions",children:"Managing Tool Permissions"})," - Fine-grained tool control"]}),"\n"]})]})}function m(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},79329:(e,t,n)=>{n.d(t,{A:()=>o});n(96540);var r=n(34164);const s={tabItem:"tabItem_Ymn6"};var i=n(74848);function o(e){let{children:t,hidden:n,className:o}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,r.A)(s.tabItem,o),hidden:n,children:t})}},65537:(e,t,n)=>{n.d(t,{A:()=>w});var r=n(96540),s=n(34164),i=n(65627),o=n(56347),l=n(50372),a=n(30604),c=n(11861),d=n(78749);function u(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??function(e){return u(e).map((e=>{let{props:{value:t,label:n,attributes:r,default:s}}=e;return{value:t,label:n,attributes:r,default:s}}))}(n);return function(e){const t=(0,c.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function p(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:n}=e;const s=(0,o.W6)(),i=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,a.aZ)(i),(0,r.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(s.location.search);t.set(i,e),s.replace({...s.location,search:t.toString()})}),[i,s])]}function g(e){const{defaultValue:t,queryString:n=!1,groupId:s}=e,i=h(e),[o,a]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=n.find((e=>e.default))??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:i}))),[c,u]=m({queryString:n,groupId:s}),[g,f]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[s,i]=(0,d.Dv)(n);return[s,(0,r.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:s}),x=(()=>{const e=c??g;return p({value:e,tabValues:i})?e:null})();(0,l.A)((()=>{x&&a(x)}),[x]);return{selectedValue:o,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);a(e),u(e),f(e)}),[u,f,i]),tabValues:i}}var f=n(9136);const x={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var j=n(74848);function b(e){let{className:t,block:n,selectedValue:r,selectValue:o,tabValues:l}=e;const a=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.a_)(),d=e=>{const t=e.currentTarget,n=a.indexOf(t),s=l[n].value;s!==r&&(c(t),o(s))},u=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=a.indexOf(e.currentTarget)+1;t=a[n]??a[0];break}case"ArrowLeft":{const n=a.indexOf(e.currentTarget)-1;t=a[n]??a[a.length-1];break}}t?.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},t),children:l.map((e=>{let{value:t,label:n,attributes:i}=e;return(0,j.jsx)("li",{role:"tab",tabIndex:r===t?0:-1,"aria-selected":r===t,ref:e=>{a.push(e)},onKeyDown:u,onClick:d,...i,className:(0,s.A)("tabs__item",x.tabItem,i?.className,{"tabs__item--active":r===t}),children:n??t},t)}))})}function y(e){let{lazy:t,children:n,selectedValue:i}=e;const o=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=o.find((e=>e.props.value===i));return e?(0,r.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:o.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==i})))})}function v(e){const t=g(e);return(0,j.jsxs)("div",{className:(0,s.A)("tabs-container",x.tabList),children:[(0,j.jsx)(b,{...t,...e}),(0,j.jsx)(y,{...t,...e})]})}function w(e){const t=(0,f.A)();return(0,j.jsx)(v,{...e,children:u(e.children)},String(t))}},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>l});var r=n(96540);const s={},i=r.createContext(s);function o(e){const t=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(i.Provider,{value:t},e.children)}},75395:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(96540);const s=(...e)=>e.filter(((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t)).join(" ").trim();var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const o=(0,r.forwardRef)((({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:o,className:l="",children:a,iconNode:c,...d},u)=>(0,r.createElement)("svg",{ref:u,...i,width:t,height:t,stroke:e,strokeWidth:o?24*Number(n)/Number(t):n,className:s("lucide",l),...d},[...c.map((([e,t])=>(0,r.createElement)(e,t))),...Array.isArray(a)?a:[a]]))),l=(e,t)=>{const n=(0,r.forwardRef)((({className:n,...i},l)=>{return(0,r.createElement)(o,{ref:l,iconNode:t,className:s(`lucide-${a=e,a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,n),...i});var a}));return n.displayName=`${e}`,n}},71112:(e,t,n)=>{n.d(t,{A:()=>r});const r=(0,n(75395).A)("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]])}}]);